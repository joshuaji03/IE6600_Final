title: "IE6600 - hw1"
author: "Joshua Ji"
output: pdf_document
---

```{r setup, include=FALSE}
# echo=T to show the code, eval=T to show the results ----
knitr::opts_chunk$set(echo = T, eval=T) 
# Pre-load packages ----
library(tidyverse)
# install.packages("sqldf") run once
library(sqldf)
#Hello
```

```{R}
FinalData_top_30 <- df[c("Cause","Deaths1")] %>% 
  group_by(Cause) %>%
  summarise(total = sum(Deaths1)) %>%
  arrange(desc(total)) %>%
  top_n(30)

temp <- merge(x = df, y = FinalData_top_30, by = "Cause", all.y = TRUE)

final_df <- sqldf("SELECT *
              FROM country df1, temp df2
              WHERE df1.code = df2.Country
              ")
names(final_df)[names(final_df) == "...1"] <- "Total_deaths"


final_df <- final_df[, !names(final_df) %in% c("Total_deaths", "code", "Cause",
                                               "total", "list", "Admin1", "SubDiv")]

final_df["country_name"][final_df["country_name"] == "\"Serbia and Montenegro"] <- "Serbia and Montenegro"
final_df["country_name"][final_df["country_name"] == "\"United Kingdom"] <- "United Kingdom"


```

```{R}
# upload country name with country code
file <- "Data/country_codes.csv"
country <- read.table(file, header = TRUE, sep = ",")
country <- separate(data = country, col = country.name, 
                    into = c("code", "country_name"), sep = "\\,")
```
```{R}
# upload Population and live births data (see documentation about more details)
file <- "Data/pop.csv"
nameLine <- readLines(con=file, n=1)
nameLine <- make.names(unlist(strsplit(nameLine,",")))
pop <- read.table(file, header = TRUE, sep = ",")
pop <- separate(data = pop, col = colnames(pop), 
                into = nameLine, sep = "\\,")
names(pop)[names(pop) == "X.Country"] <- "Country"
names(pop)[names(pop) == "Lb."] <- "Lb"
```

```{R}
# only execute once, write the note file from WHO into readable .csv file
# write notes
file <- "Notes/notes.csv"
nameLine <- readLines(con=file, n=1)
nameLine <- make.names(unlist(strsplit(nameLine,",")))
notes <- read.csv(file, header = TRUE, sep = ",")
notes <- separate(data = notes, col = colnames(notes), 
                into = nameLine, sep = "\\,")
write.csv(notes,"notes.csv", row.names = FALSE)
```


```{R}
# check what age formats exist in the df
pop %>%
  group_by(Frmat) %>%
  summarise(n = n())

# read age reference table into R
file <- "Data/age_ref.csv"
age_ref <- read_csv(file)
age_ref <- head(age_ref, 10) jt
```

```{R}
# temp table that combines country name table to population table
temp <- sqldf("SELECT *
              FROM country df1, pop df2
              WHERE df1.code = df2.Country
              ")
```

```{R}






```

